---
title: "HW2"
author: "Glebus Alexandr"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(ggplot2)
```

## 1. Загрузите датасет life_expectancy_data.RDS (лежит в папке домашнего задания).Это данные с основными показателями, через которые высчитывается ожидаемая продолжительности жизни по метрике World Development Indicator на уровне стран2. В данных оставлены строки, относящиеся к положению женщин в 2019 г.

```{r}
life_expectancy_data <- readr::read_rds('life_expectancy_data.RDS')
life_expectancy_data %>% glimpse()
life_expectancy_data %>% 
```


```{r}
library(plotly)
plot_ly(data = life_expectancy_data[(life_expectancy_data$`Rural population` != 0) & (life_expectancy_data$`Sucide Rate` != 0),],
        x = ~ `Rural population`,
        y = ~ `Sucide Rate`,
        color = ~ continent)
```


## 2. Проведите тест, на сравнение распределений колонки `Life expectancy` между группами стран Африки и Америки. Вид статистического теста определите самостоятельно. Визуализируйте результат через библиотеку `rstatix`.

```{r}
library(rstatix)
life_expectancy_data %>% 
  filter(continent == 'Africa' | continent == 'Americas') %>% 
  t.test(`Life expectancy` ~ continent)
```

```{r}
library(ggpubr)
stat.test <-  t.test(Americas$`Life expectancy`, Africa$`Life expectancy`)  %>% 
  add_xy_position(x = "diabetes_ch")

ggboxplot(
  pima[pima$pressure>5,], 
  x = "diabetes_ch", y = "pressure", 
  ylab = "Pressure", xlab = "Diabete", 
  add = "jitter"
  ) + 
  labs(subtitle = get_test_label(stat.test, detailed = TRUE)) + 
  stat_pvalue_manual(stat.test, tip.length = 0)

```



